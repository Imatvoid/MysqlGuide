## 常用命令



### 用户管理

```mysql
#登陆
mysql -uroot -p
#查看用户
use mysql;
mysql>select host,user from mysql.user;

mysql> CREATE USER 'username'@'host' IDENTIFIED BY 'password';  #创建用户
mysql> GRANT ALL PRIVILEGES ON databasename.tablename TO 'username'@'host';
#privileges：用户的操作权限，如 SELECT，INSERT，UPDATE 等，如果要授予所的权限则使用ALL
mysql> SHOW GRANTS FOR 'username'@'host';
mysql> REVOKE privilege ON databasename.tablename FROM 'username'@'host';
mysql> DROP USER 'username'@'host';
```



- username：你将创建的用户名
- host：指定该用户在哪个主机上可以登陆，如果是本地用户可用 localhost，如果想让该用户可以从任意远程主机登陆，可以使用通配符 %
- password：该用户的登陆密码，密码可以为空，如果为空则该用户可以不需要密码登陆服务器
- privileges：用户的操作权限，如 SELECT，INSERT，UPDATE 等，如果要授予所的权限则使用ALL
- databasename：数据库名
- tablename：表名，如果要授予该用户对所有数据库和表的相应操作权限则可用 * 表示，如 *.*



### 忘记root密码重置

修改MySQL的配置文件（默认为/etc/my.cnf）,在[mysqld]下添加一行skip-grant-tables

保存配置文件后，重启MySQL服务 service mysqld restart

再次进入MySQL命令行 mysql -uroot -p,输入密码时直接回车，就会进入MySQL数据库了，这个时候按照常规流程修改root密码即可。

```mysql
#更改数据库
mysql>use mysql;    

#  旧版
mysql>UPDATE user SET PASSORD =password("passwd") WHERE USER= 'root';  #重设密码
#  新版
mysql>UPDATE user SET authentication_string =password("passwd") WHERE USER= 'root';  #重设密码
UPDATE user SET authentication_string =password("123Pppp") WHERE USER= 'xu' and host = '%';
# 刷新MySQL的系统权限相关表，以防止更改后拒绝访问；或或者重启MySQL服务器
# 密码修改完毕后，再按照步骤1中的流程，删掉配置文件中的那行，并且重启MySQL服务，新密码就生效了。
mysql>flush privileges; 

```



### 增加索引

```mysql
# 普通索引
ALTER TABLE `table_name` ADD INDEX index_name ( `column` ) 
```







### Explain

```mysql

| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra |

#id 包含一组数字，表示查询中执行select子句或操作表的顺序（id相同为同组，执行顺序由上至下） 不同组越大先执行

#select_type 表示查询中每个select子句的类型（简单OR复杂）

#type 表示MySQL在表中找到所需行的方式，又称“访问类型”，常见类型如下:
#ALL, index,  range, ref, eq_ref, const, system, NULL
#ALL：Full Table Scan， MySQL将遍历全表以找到匹配的行
#index：Full Index Scan，index与ALL区别为index类型只遍历索引树
#range:索引范围扫描，对索引的扫描开始于某一点，返回匹配值域的行。显而易见的索引范围扫描是带有between或者where子句里带有<, >查询。当mysql使用索引去查找一系列值时，例如IN()和OR列表，也会显示range（范围扫描）,当然性能上面是有差异的。
#ref：使用非唯一索引扫描或者唯一索引的前缀扫描，返回匹配某个单独值的记录行
#eq_ref：类似ref，区别就在使用的索引是唯一索引，对于每个索引键值，表中只有一条记录匹配，简单来说，就是多表连接中使用primary key或者 unique key作为关联条件
#const、system：当MySQL对查询某部分进行优化，并转换为一个常量时，使用这些类型访问。如将主键置于where列表中，MySQL就能将该查询转换为一个常量
#NULL：MySQL在优化过程中分解语句，执行时甚至不用访问表或索引，例如从一个索引列里选取最小值可以通过单独索引查找完成。



```

<https://www.cnblogs.com/gomysql/p/3720123.html>